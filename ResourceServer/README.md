# Twister Resource Server
Stateless CQRS and REST API [resource server](https://www.oauth.com/oauth2-servers/the-resource-server/).

## Model scheme
### Autogenerated
Tables to maintain sequnced and autogenerate names and numbers.
```mermaid
erDiagram
ACCOUNT_NUMBER {
    varchar(64) number PK
}

CASE_SLOT_NAME {
    varchar(64) name PK
}

GENERAL_ACCOUNT_NAME {
    varchar(64) name PK
}

INVENTORIES_NAME {
    varchar(64) name PK
}

TWIST_NUMBER {
    varchar(64) number PK
}

GENERAL_ACCOUNTS ||--|| GENERAL_ACCOUNT_NAME : "named"
GENERAL_ACCOUNTS {
bigint id PK
varchar(64) name UK, FK
varchar(64) user_uuid UK
varchar(64) nickname UK
timestamp(6) modified_by
timestamp(6) created_on
}

ACCOUNTS ||--|| ACCOUNT_NUMBER : "numerated"
ACCOUNTS {
bigint id PK
varchar(64) number FK, UK
numeric amount
integer money_type_id FK
bigint general_account_id FK
timestamp(6) modified_by
timestamp(6) created_on
}

INVENTORIES ||--|| INVENTORIES_NAME : "named"
INVENTORIES {
bigint id PK
varchar(64) name UK, FK
bigint general_account_id FK
timestamp(6) modified_by
timestamp(6) created_on
}

TWISTES ||--|| TWIST_NUMBER : "numerated"
TWISTES {
bigint id PK
varchar(64) number UK, FK
bigint account_id FK
bigint case_id FK
bigint general_account_id FK
integer quantity_item
bigint item_id FK
timestamp(6) created_on
}

CASE_SLOTS ||--|| CASE_SLOT_NAME : "named"
CASE_SLOTS {
bigint id PK
varchar(64) name UK, FK
integer quantity_item
bigint case_id FK
bigint item_id FK
numeric win_rate
}
```

### User possessions

#### Interserver relationship

A separate auth server for OAuth2 forces a cross-server connection via the uuid that will be in the jwt.
```mermaid
erDiagram

USER_PRINCIPAL {
varchar(64) user_uuid UK
}

GENERAL_ACCOUNTS }|--|| USER_PRINCIPAL : "has"
GENERAL_ACCOUNTS {
bigint id PK
varchar(64) name UK, FK
varchar(64) user_uuid UK
varchar(64) nickname UK
timestamp(6) modified_by
timestamp(6) created_on
}
```

#### General account
Each general account can own accounts for a certain type of money and inventory for storing items.

```mermaid
erDiagram

GENERAL_ACCOUNTS {
bigint id PK
varchar(64) name UK, FK
varchar(64) user_uuid UK
varchar(64) nickname UK
timestamp(6) modified_by
timestamp(6) created_on
}

ACCOUNTS }|--|| GENERAL_ACCOUNTS : "has"
ACCOUNTS {
bigint id PK
varchar(64) number FK, UK
numeric amount
integer money_type_id FK
bigint general_account_id FK
timestamp(6) modified_by
timestamp(6) created_on
}

INVENTORIES }|--|| GENERAL_ACCOUNTS : "has"
INVENTORIES {
bigint id PK
varchar(64) name UK, FK
bigint general_account_id FK
timestamp(6) modified_by
timestamp(6) created_on
}
```
#### Inventory
So each inventory contains slots for some item.
```mermaid
erDiagram

INVENTORIES {
bigint id PK
varchar(64) name UK, FK
bigint general_account_id FK
timestamp(6) modified_by
timestamp(6) created_on
}

INVENTORY_SLOTS }|--|| INVENTORIES : "has"
INVENTORY_SLOTS {
bigint id PK
integer quantity_item
bigint inventory_id FK
bigint item_id FK
}
```
##### Inventory slot
Each slot contains both the number of items and the items themselves.
```mermaid
erDiagram

INVENTORY_SLOTS }|--|| ITEM : "in"
INVENTORY_SLOTS {
bigint id PK
integer quantity_item
bigint inventory_id FK
bigint item_id FK
}

ITEM {
bigint id PK
varchar(64) name UK, FK
varchar(64) visible_name
timestamp(6) modified_by
timestamp(6) created_on
}
```
#### Account
Each account is tied to some type of money.

```mermaid
erDiagram

ACCOUNTS }|--|| MONEY_TYPE : "typed"
ACCOUNTS {
bigint id PK
varchar(64) number FK, UK
numeric amount
integer money_type_id FK
bigint general_account_id FK
timestamp(6) modified_by
timestamp(6) created_on
}

MONEY_TYPE {
integer id PK
varchar(64) name UK, FK
varchar(64) pathToIcon
timestamp(6) modified_by
timestamp(6) created_on
}
```

#### Full
So, the full ownership scheme:
```mermaid
erDiagram
USER_PRINCIPAL {
varchar(64) user_uuid UK
}

GENERAL_ACCOUNTS }|--|| USER_PRINCIPAL : "has"
GENERAL_ACCOUNTS {
bigint id PK
varchar(64) name UK, FK
varchar(64) user_uuid UK
varchar(64) nickname UK
timestamp(6) modified_by
timestamp(6) created_on
}

ACCOUNTS }|--|| MONEY_TYPE : "typed"
ACCOUNTS }|--|| GENERAL_ACCOUNTS : "has"
ACCOUNTS {
bigint id PK
varchar(64) number FK, UK
numeric amount
integer money_type_id FK
bigint general_account_id FK
timestamp(6) modified_by
timestamp(6) created_on
}

INVENTORIES }|--|| GENERAL_ACCOUNTS : "has"
INVENTORIES {
bigint id PK
varchar(64) name UK, FK
bigint general_account_id FK
timestamp(6) modified_by
timestamp(6) created_on
}

INVENTORY_SLOTS }|--|| INVENTORIES : "has"
INVENTORY_SLOTS }|--|| ITEM : "in"
INVENTORY_SLOTS {
bigint id PK
integer quantity_item
bigint inventory_id FK
bigint item_id FK
}

ITEM {
bigint id PK
varchar(64) name UK, FK
varchar(64) visible_name
timestamp(6) modified_by
timestamp(6) created_on
}

MONEY_TYPE {
integer id PK
varchar(64) name UK, FK
varchar(64) pathToIcon
timestamp(6) modified_by
timestamp(6) created_on
}
```

### Infrastructure around
#### Item
There are currently two types of items: trash and money. The key difference is that ItemMoney has a price in the form of some type of money.
```mermaid
erDiagram

ITEM {
bigint id PK
varchar(64) name UK, FK
varchar(64) visible_name
timestamp(6) modified_by
timestamp(6) created_on
}

ITEM_MONEY }|--|| MONEY_TYPE : "typed"
ITEM_MONEY ||--|| ITEM : "inheritor"
ITEM_MONEY {
bigint item_money_id PK, FK
integer money_type_id FK
numeric cost
}

ITEM_TRASH ||--|| ITEM : "inheritor"
ITEM_TRASH {
bigint item_trash_id PK, FK
}

MONEY_TYPE {
integer id PK
varchar(64) name UK, FK
varchar(64) pathToIcon
timestamp(6) modified_by
timestamp(6) created_on
}
```
#### Case
The case consists of slots with items and a certain chance of falling out, as well as the cost in the equivalent of a certain type of money.
```mermaid
erDiagram
CASES }|--|| MONEY_TYPE : "typed"
CASES {
bigint id PK
varchar(64) name UK
integer money_type_id FK
numeric price
numeric cooldown
varchar(64) visible_name
varchar(1000) description
timestamp(6) modified_by
timestamp(6) created_on
}

CASE_SLOTS }|--|| CASES : "has"
CASE_SLOTS }|--|| ITEM : "in"
CASE_SLOTS {
bigint id PK
varchar(64) name UK, FK
integer quantity_item
bigint case_id FK
bigint item_id FK
numeric win_rate
}

ITEM {
bigint id PK
varchar(64) name UK, FK
varchar(64) visible_name
timestamp(6) modified_by
timestamp(6) created_on
}

MONEY_TYPE {
integer id PK
varchar(64) name UK, FK
varchar(64) pathToIcon
timestamp(6) modified_by
timestamp(6) created_on
}
```
#### Twist
TWIST - logging table for each twist case. TWIST_MARK - conditional trigger table to account for case cooldowns. There is a condition whether it is worth considering this mark at all.
```mermaid
erDiagram
ITEM {
bigint id PK
varchar(64) name UK, FK
varchar(64) visible_name
timestamp(6) modified_by
timestamp(6) created_on
}

GENERAL_ACCOUNTS {
bigint id PK
varchar(64) name UK, FK
varchar(64) user_uuid UK
varchar(64) nickname UK
timestamp(6) modified_by
timestamp(6) created_on
}

ACCOUNTS {
bigint id PK
varchar(64) number FK, UK
numeric amount
integer money_type_id FK
bigint general_account_id FK
timestamp(6) modified_by
timestamp(6) created_on
}

CASES {
bigint id PK
varchar(64) name UK
integer money_type_id FK
numeric price
numeric cooldown
varchar(64) visible_name
varchar(1000) description
timestamp(6) modified_by
timestamp(6) created_on
}

TWIST_MARKS }|--|| CASES : "grouped"
TWIST_MARKS }|--|| GENERAL_ACCOUNTS : "grouped"
TWIST_MARKS {
integer id PK
bigint twist_case_id FK
bigint general_account_id FK
boolean consider
timestamp(6) updated_on
timestamp(6) created_on
}

TWISTES }|--|| CASES : "log"
TWISTES }|--|| GENERAL_ACCOUNTS : "log"
TWISTES }|--|| ACCOUNTS : "log"
TWISTES }|--|| ITEM : "log"
TWISTES {
bigint id PK
varchar(64) number UK, FK
bigint account_id FK
bigint case_id FK
bigint general_account_id FK
integer quantity_item
bigint item_id FK
timestamp(6) created_on
}
```

### Full
Full scheme:
```mermaid
erDiagram
ACCOUNT_NUMBER {
    varchar(64) number PK
}

CASE_SLOT_NAME {
varchar(64) name PK
}

GENERAL_ACCOUNT_NAME {
varchar(64) name PK
}

INVENTORIES_NAME {
varchar(64) name PK
}

TWIST_NUMBER {
varchar(64) number PK
}

GENERAL_ACCOUNTS ||--|| GENERAL_ACCOUNT_NAME : "named"
GENERAL_ACCOUNTS {
bigint id PK
varchar(64) name UK, FK
varchar(64) user_uuid UK
varchar(64) nickname UK
timestamp(6) modified_by
timestamp(6) created_on
}

ACCOUNTS }|--|| MONEY_TYPE : "typed"
ACCOUNTS }|--|| GENERAL_ACCOUNTS : "has"
ACCOUNTS ||--|| ACCOUNT_NUMBER : "numerated"
ACCOUNTS {
bigint id PK
varchar(64) number FK, UK
numeric amount
integer money_type_id FK
bigint general_account_id FK
timestamp(6) modified_by
timestamp(6) created_on
}

INVENTORIES }|--|| GENERAL_ACCOUNTS : "has"
INVENTORIES ||--|| INVENTORIES_NAME : "named"
INVENTORIES {
bigint id PK
varchar(64) name UK, FK
bigint general_account_id FK
timestamp(6) modified_by
timestamp(6) created_on
}

INVENTORY_SLOTS }|--|| INVENTORIES : "has"
INVENTORY_SLOTS }|--|| ITEM : "in"
INVENTORY_SLOTS {
bigint id PK
integer quantity_item
bigint inventory_id FK
bigint item_id FK
}

CASES }|--|| MONEY_TYPE : "typed"
CASES {
bigint id PK
varchar(64) name UK
integer money_type_id FK
numeric price
numeric cooldown
varchar(64) visible_name
varchar(1000) description
timestamp(6) modified_by
timestamp(6) created_on
}

CASE_SLOTS ||--|| CASE_SLOT_NAME : "named"
CASE_SLOTS }|--|| CASES : "has"
CASE_SLOTS }|--|| ITEM : "in"
CASE_SLOTS {
bigint id PK
varchar(64) name UK, FK
integer quantity_item
bigint case_id FK
bigint item_id FK
numeric win_rate
}

ITEM {
bigint id PK
varchar(64) name UK, FK
varchar(64) visible_name
timestamp(6) modified_by
timestamp(6) created_on
}

ITEM_MONEY }|--|| MONEY_TYPE : "typed"
ITEM_MONEY ||--|| ITEM : "inheritor"
ITEM_MONEY {
bigint item_money_id PK, FK
integer money_type_id FK
numeric cost
}

ITEM_TRASH ||--|| ITEM : "inheritor"
ITEM_TRASH {
bigint item_trash_id PK, FK
}

MONEY_TYPE {
integer id PK
varchar(64) name UK, FK
varchar(64) pathToIcon
timestamp(6) modified_by
timestamp(6) created_on
}

TWIST_MARKS }|--|| CASES : "grouped"
TWIST_MARKS }|--|| GENERAL_ACCOUNTS : "grouped"
TWIST_MARKS {
integer id PK
bigint twist_case_id FK
bigint general_account_id FK
boolean consider
timestamp(6) updated_on
timestamp(6) created_on
}

TWISTES }|--|| CASES : "log"
TWISTES }|--|| GENERAL_ACCOUNTS : "log"
TWISTES }|--|| ACCOUNTS : "log"
TWISTES }|--|| ITEM : "log"
TWISTES ||--|| TWIST_NUMBER : "numerated"
TWISTES {
bigint id PK
varchar(64) number UK, FK
bigint account_id FK
bigint case_id FK
bigint general_account_id FK
integer quantity_item
bigint item_id FK
timestamp(6) created_on
}
```
## Component scheme
Because the service is CQRS, the components have limitations. 

Firstly, only `@Repository`, `@InformationService`, `@RegisterService`, `@MergeService` are allowed to `@Autowired` repository `@Component`s.
Secondly,
- if `@Repository` does not have restrictions on the applicable methods in these repositories, but the latter cannot `@Autowired` other services;

- `@InformationService` - can only be used by `Repository#find`/`Repository#get`;

- `@RegisterService` - can only be used by `EntityManager#persistence`;

- `@MergeService` - can only be used by `EntityManager#merge`;

- `@PutService` - can only be used by `Repository#find`/`Repository#get`.

Thus, each service always returns `@Dto`, which means the persistence context cannot go beyond the previously designated service types. The problem of passing `@Entity` without persistence context is solved by `@MappingDto`. It turns out that if you need to somehow modify an `@Entity`, then from `@InformationService` you get `@MappingDto`, which is mapped to `@Entity`, some action is performed on it, this `@Entity` is again mapped to some `@MappingDto` and passed to `@MergeService`. The problem of n+1 and the Cartesian product is solved by the complete absence of `@OneToMany` in `@Entity`, as well as the ability to save `@ManyToOne` only by id.

Now you can easily introduce a division: all services that have a persistence context are collected in the services.managers package.
### Transfer Money Service
```mermaid
classDiagram
direction BT
class AccountInformationService {
  + getFull(GeneralAccountNameRequestDto, AccountNumberRequestDto) AccountFullDto
  + getPartial(GeneralAccountNameRequestDto, AccountNumberRequestDto) AccountPartialResponseDto
  + getPartials(GeneralAccountNameRequestDto) List~AccountPartialResponseDto~
  + getPublic(AccountNumberRequestDto) AccountDebitResponseDto
  + getFull(GeneralAccountIdAndUuidDto, AccountNumberRequestDto) AccountFullDto
}
class AccountMergeService {
  + merge(AccountFullDto) AccountPartialResponseDto
}
class GeneralAccountInformationService {
  + getId(GeneralAccountNameRequestDto) GeneralAccountIdAndUuidDto
  + getFull(GeneralAccountNameRequestDto) GeneralAccountFullDto
  + getPartial(GeneralAccountNameRequestDto) GeneralAccountPartialResponseDto
  + getPublic(GeneralAccountNicknameRequestDto) GeneralAccountPublicResponseDto
  + getName(UserPrincipal) GeneralAccountNameResponseDto
  + getPublic(GeneralAccountNameRequestDto) GeneralAccountPublicResponseDto
}
class MoneyTypeInformationService {
  + getPartial(MoneyTypeNameRequestDto) MoneyTypePartialResponseDto
  + getFull(MoneyTypeNameRequestDto) MoneyTypeFullDto
  + getPartials() List~MoneyTypePartialResponseDto~
  + getId(MoneyTypeNameRequestDto) MoneyTypeIdResponseDto
}
class TransferMoneyService {
  + debit(AccountNumberRequestDto, MoneyFullDto) void
  + credit(GeneralAccountNameRequestDto, AccountNumberRequestDto, MoneyFullDto) void
  + transfer(GeneralAccountNameRequestDto, AccountNumberRequestDto, AccountNumberRequestDto, MoneyCreateRequestDto) void
}

AccountInformationService "1" *--> "generalAccountInformationService 1" GeneralAccountInformationService 
TransferMoneyService "1" *--> "accountInformationService 1" AccountInformationService 
TransferMoneyService "1" *--> "mergeAccountService 1" AccountMergeService 
TransferMoneyService "1" *--> "moneyTypeInformationService 1" MoneyTypeInformationService 

```
### Transfer Item Service 
```mermaid
classDiagram
direction BT
class GeneralAccountInformationService {
  + getId(GeneralAccountNameRequestDto) GeneralAccountIdAndUuidDto
  + getFull(GeneralAccountNameRequestDto) GeneralAccountFullDto
  + getPartial(GeneralAccountNameRequestDto) GeneralAccountPartialResponseDto
  + getPublic(GeneralAccountNicknameRequestDto) GeneralAccountPublicResponseDto
  + getName(UserPrincipal) GeneralAccountNameResponseDto
  + getPublic(GeneralAccountNameRequestDto) GeneralAccountPublicResponseDto
}
class InventoryInformationService {
  + getInventoryId(GeneralAccountNameRequestDto, InventoryNameRequestDto) InventoryIdDto
  + getInventoryNames(GeneralAccountNameRequestDto) List~InventoryNameResponseDto~
  + getInventoryPartial(GeneralAccountNameRequestDto, InventoryNameRequestDto) InventoryPartialSlotsResponseDto
  + getDebit(InventoryNameRequestDto) InventoryDebitResponseDto
  + getSlotPartial(GeneralAccountNameRequestDto, InventoryNameRequestDto, ItemNameRequestDto) SlotPartialResponseDto
  + getId(GeneralAccountNameRequestDto, InventoryNameRequestDto) InventoryIdDto
}
class InventorySlotInformationService {
  + getPartial(InventoryIdDto, ItemIdDto) SlotPartialResponseDto
  + getPartials(InventoryIdDto) List~SlotPartialResponseDto~
  + getFull(InventoryIdDto, ItemIdDto) InventorySlotFullDto
  + getId(InventoryIdDto, ItemIdDto) SlotIdDto
}
class InventorySlotMergeService {
  + merge(InventorySlotFullDto) void
}
class InventorySlotPutService {
  + putIfAbsent(InventorySlotPutDto) void
}
class InventorySlotRegisterService {
  + register(InventorySlotRegisterDto) void
}
class TransferItemService {
  + add(InventoryNameRequestDto, SlotActionDto) void
  + transfer(GeneralAccountNameRequestDto, InventoryNameRequestDto, InventoryNameRequestDto, SlotActionDto) void
  + remove(GeneralAccountNameRequestDto, InventoryNameRequestDto, SlotActionDto) void
}

InventoryInformationService "1" *--> "1" GeneralAccountInformationService 
InventoryInformationService "1" *--> "1" InventorySlotInformationService 
InventorySlotPutService "1" *--> "1" InventorySlotMergeService 
InventorySlotPutService "1" *--> "1" InventorySlotRegisterService 
TransferItemService "1" *--> "1" InventoryInformationService 
TransferItemService "1" *--> "1" InventorySlotInformationService 
TransferItemService "1" *--> "1" InventorySlotMergeService 
TransferItemService "1" *--> "1" InventorySlotPutService 
```
### Shop Service
```mermaid
classDiagram
direction BT
class ItemInformationService {
  + getPartials() List~ItemPartialResponseDto~
  + getId(ItemNameRequestDto) ItemIdDto
  + getPartial(ItemNameRequestDto) ItemPartialResponseDto
  + getFull(ItemNameRequestDto) ItemFullDto
}
class MoneyTypeInformationService {
  + getPartial(MoneyTypeNameRequestDto) MoneyTypePartialResponseDto
  + getFull(MoneyTypeNameRequestDto) MoneyTypeFullDto
  + getPartials() List~MoneyTypePartialResponseDto~
  + getId(MoneyTypeNameRequestDto) MoneyTypeIdResponseDto
}
class ShopService {
  + buy(GeneralAccountNameRequestDto, InventoryNameRequestDto, SlotActionDto, AccountNumberRequestDto, MoneyCreateRequestDto) void
  + sell(GeneralAccountNameRequestDto, InventoryNameRequestDto, ItemNameRequestDto, AccountNumberRequestDto, SlotQuantityRequestDto) void
}
class TransferItemService {
  + add(InventoryNameRequestDto, SlotActionDto) void
  + transfer(GeneralAccountNameRequestDto, InventoryNameRequestDto, InventoryNameRequestDto, SlotActionDto) void
  + remove(GeneralAccountNameRequestDto, InventoryNameRequestDto, SlotActionDto) void
}
class TransferMoneyService {
  + debit(AccountNumberRequestDto, MoneyFullDto) void
  + credit(GeneralAccountNameRequestDto, AccountNumberRequestDto, MoneyFullDto) void
  + transfer(GeneralAccountNameRequestDto, AccountNumberRequestDto, AccountNumberRequestDto, MoneyCreateRequestDto) void
}

ShopService "1" *--> "1" ItemInformationService 
ShopService "1" *--> "1" MoneyTypeInformationService 
ShopService "1" *--> "1" TransferItemService 
ShopService "1" *--> "1" TransferMoneyService 
TransferMoneyService "1" *--> "1" MoneyTypeInformationService 
```


### Twist Service
```mermaid
classDiagram
direction BT
class AccountInformationService {
  + getFull(GeneralAccountNameRequestDto, AccountNumberRequestDto) AccountFullDto
  + getPartial(GeneralAccountNameRequestDto, AccountNumberRequestDto) AccountPartialResponseDto
  + getPartials(GeneralAccountNameRequestDto) List~AccountPartialResponseDto~
  + getPublic(AccountNumberRequestDto) AccountDebitResponseDto
  + getFull(GeneralAccountIdAndUuidDto, AccountNumberRequestDto) AccountFullDto
}
class CaseActualInformationService {
  + getPage(int, int, GeneralAccountNameRequestDto) CasePagePartialResponseDto
  + getFull(GeneralAccountNameRequestDto, CaseNameRequestDto) CaseFullDto
  + getPartialItems(GeneralAccountNameRequestDto, CaseNameRequestDto) CaseItemsPartialResponseDto
}
class CaseSlotInformationService {
  + getFullsOrdersWinRate(CaseIdDto) List~CaseSlotFullDto~
  + getPartials(CaseIdDto) List~CaseSlotPartialResponseDto~
}
class GeneralAccountInformationService {
  + getId(GeneralAccountNameRequestDto) GeneralAccountIdAndUuidDto
  + getFull(GeneralAccountNameRequestDto) GeneralAccountFullDto
  + getPartial(GeneralAccountNameRequestDto) GeneralAccountPartialResponseDto
  + getPublic(GeneralAccountNicknameRequestDto) GeneralAccountPublicResponseDto
  + getName(UserPrincipal) GeneralAccountNameResponseDto
  + getPublic(GeneralAccountNameRequestDto) GeneralAccountPublicResponseDto
}
class ShopService {
  + buy(GeneralAccountNameRequestDto, InventoryNameRequestDto, SlotActionDto, AccountNumberRequestDto, MoneyCreateRequestDto) void
  + sell(GeneralAccountNameRequestDto, InventoryNameRequestDto, ItemNameRequestDto, AccountNumberRequestDto, SlotQuantityRequestDto) void
}
class TwistMarkInformationService {
  + getFull(GeneralAccountIdAndUuidDto, CaseIdDto) TwistMarkFullDto
}
class TwistMarkMergeService {
  + merge(TwistMarkFullDto) void
}
class TwistMarkPutService {
  + putIfAbsent(TwistMarkPutDto) void
}
class TwistMarkRegisterService {
  + register(TwistMarkRegisterDto) void
}
class TwistRegisterService {
  + register(CaseFullDto, GeneralAccountIdAndUuidDto, AccountFullDto, CaseSlotFullDto) TwistPartialResponseDto
  + register(TwistRegisterDto) TwistPartialResponseDto
}
class TwistService {
  + twist(GeneralAccountNameRequestDto, InventoryNameRequestDto, AccountNumberRequestDto, CaseNameRequestDto) TwistPartialResponseDto
}

AccountInformationService "1" *--> "generalAccountInformationService 1" GeneralAccountInformationService 
CaseActualInformationService "1" *--> "caseSlotInformationService 1" CaseSlotInformationService 
CaseActualInformationService "1" *--> "generalAccountInformationService 1" GeneralAccountInformationService 
TwistMarkPutService "1" *--> "twistMarkMergeService 1" TwistMarkMergeService 
TwistMarkPutService "1" *--> "twistMarkRegisterService 1" TwistMarkRegisterService 
TwistService "1" *--> "accountInformationService 1" AccountInformationService 
TwistService "1" *--> "caseActualInformationService 1" CaseActualInformationService 
TwistService "1" *--> "caseSlotInformationService 1" CaseSlotInformationService 
TwistService "1" *--> "generalAccountInformationService 1" GeneralAccountInformationService 
TwistService "1" *--> "shopService 1" ShopService 
TwistService "1" *--> "twistMarkInformationService 1" TwistMarkInformationService 
TwistService "1" *--> "twistMarkMergeService 1" TwistMarkMergeService 
TwistService "1" *--> "twistMarkPutService 1" TwistMarkPutService 
TwistService "1" *--> "twistRegisterService 1" TwistRegisterService 
```